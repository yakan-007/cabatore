# 会話練習AI × 天の声フィードバック
## プロトタイプ設計書 v1.0

---

## 🎯 プロダクト概要

ユーザーがAI会話Botと練習しながら、リアルタイムで「天の声」からフィードバックを受け取る会話改善支援システム。

---

## 📱 UI/UX設計

### 画面構成

```
┌─────────────────────────────────────┐
│  会話練習AI - 天の声つき          ⚙│
├─────────────────────────────────────┤
│                                     │
│  👤 Bot                             │
│  ┌─────────────────────────┐       │
│  │ こんにちは！今日は何に   │       │
│  │ ついて話しましょうか？   │       │
│  └─────────────────────────┘       │
│                                     │
│  💭 天の声                          │
│  「いい出だし！相手を受け入れる     │
│   姿勢が伝わってきます」            │
│                                     │
│  👤 あなた                          │
│  ┌─────────────────────────┐       │
│  │ えーっと、最近仕事が     │       │
│  │ 忙しくて...              │       │
│  └─────────────────────────┘       │
│                                     │
│  💭 天の声                          │
│  「ちょっとネガティブスタート？     │
│   明るい話題から入るのもアリ！」    │
│                                     │
├─────────────────────────────────────┤
│ ┌─────────────────────────────────┐│
│ │ メッセージを入力...              ││
│ └─────────────────────────────────┘│
│                        [送信] [🎙]  │
└─────────────────────────────────────┘
```

### インタラクションフロー

1. ユーザーがメッセージ入力
2. Botが返答（0.5-1秒）
3. 天の声フィードバック表示（1-2秒後）
4. ユーザーが次の発話

---

## 🏗 技術アーキテクチャ

### システム構成

```
┌──────────────┐     ┌─────────────────┐
│   Frontend   │────▶│   Backend API   │
│  (React/Vue) │     │   (Python/Node) │
└──────────────┘     └────────┬────────┘
                              │
                     ┌────────┴────────┐
                     │                 │
              ┌──────▼──────┐ ┌───────▼──────┐
              │ Bot生成API  │ │天の声生成API │
              │ (GPT/Claude)│ │(GPT/Claude)  │
              └─────────────┘ └──────────────┘
```

### API仕様

#### 1. 会話送信API
```json
POST /api/conversation/message
{
  "session_id": "xxx-xxx-xxx",
  "user_message": "えーっと、最近仕事が忙しくて...",
  "conversation_history": [...]
}

Response:
{
  "bot_response": "お疲れ様です！忙しい時期なんですね",
  "voice_feedback": "ちょっとネガティブスタート？明るい話題から入るのもアリ！",
  "detected_patterns": ["negative_start", "vague_expression"]
}
```

#### 2. セッション管理API
```json
POST /api/session/create
Response:
{
  "session_id": "xxx-xxx-xxx",
  "created_at": "2024-01-20T10:00:00Z"
}
```

---

## 🚀 最小実装プロトタイプ（MVP）

### Phase 1: 基本機能（1-2週間）

**実装内容:**
- シンプルなチャット画面
- Bot返答機能（固定プロンプト）
- 天の声フィードバック（基本5パターン検出）
- セッション管理

**技術選択:**
- Frontend: React + TypeScript
- Backend: FastAPI (Python)
- AI: OpenAI API (gpt-3.5-turbo)
- DB: SQLite（プロトタイプ段階）

### Phase 2: 機能拡張（2-3週間）

**追加機能:**
- 10種類の会話パターン検出
- フィードバック履歴表示
- 音声入力対応
- レスポンシブデザイン

### Phase 3: 成長機能（1ヶ月）

**高度な機能:**
- 個人の癖分析ダッシュボード
- 成長グラフ表示
- カスタマイズ可能なBot性格
- エクスポート機能

---

## 📊 会話パターン検出ロジック

### 検出パターン定義

```python
patterns = {
    "topic_drift": {
        "keywords": ["ところで", "そういえば", "話は変わるけど"],
        "logic": "前の話題との関連性スコア < 0.3"
    },
    "empathy_lack": {
        "keywords": ["でも", "だけど", "いや"],
        "logic": "相手の感情への言及なし + 反論開始"
    },
    "monologue": {
        "logic": "3文以上の連続発話 + 疑問文なし"
    },
    "negative_tone": {
        "keywords": ["つらい", "大変", "嫌", "面倒"],
        "logic": "ネガティブ語彙出現率 > 30%"
    }
}
```

### フィードバック生成プロンプト

```
あなたは会話コーチです。
以下の会話を見て、最後のユーザー発言について
20文字以内で軽いアドバイスをしてください。

[会話履歴]
Bot: {bot_message}
User: {user_message}

検出されたパターン: {detected_patterns}

フィードバックは親しみやすく、
押し付けがましくない表現で。
```

---

## 🔒 セキュリティ・プライバシー

### データ管理方針

1. **一時保存のみ**
   - セッションデータは24時間で自動削除
   - 長期保存は明示的な同意取得後のみ

2. **匿名化処理**
   - ユーザーIDはハッシュ化
   - 個人情報は一切保存しない

3. **アクセス制御**
   - HTTPS通信必須
   - APIキー認証実装

---

## 💰 コスト試算

### API利用料（月間）

```
想定利用量: 1000ユーザー × 20会話/日 × 30日
= 600,000会話ターン

1ターンあたり:
- Bot生成: 300トークン
- 天の声生成: 200トークン
計: 500トークン × 600,000 = 3億トークン

GPT-3.5-turbo料金:
約 $450/月
```

### インフラコスト

- サーバー: $20-50/月（AWS/GCP）
- DB: $10/月
- その他: $20/月

**合計: 約$500-600/月**

---

## 📈 開発ロードマップ

### Week 1-2: MVP開発
- [ ] 環境構築
- [ ] 基本UI実装
- [ ] API接続
- [ ] 基本フィードバック実装

### Week 3-4: 改善
- [ ] UIブラッシュアップ
- [ ] パターン検出精度向上
- [ ] パフォーマンス最適化

### Month 2: 拡張
- [ ] 分析機能追加
- [ ] モバイル対応
- [ ] ユーザーテスト実施

---

## 🎯 成功指標（KPI）

1. **エンゲージメント**
   - 平均セッション時間: 10分以上
   - 継続率: 1週間後30%以上

2. **効果測定**
   - フィードバック改善率: 60%以上
   - ユーザー満足度: 4.0/5.0以上

3. **技術指標**
   - レスポンス時間: 2秒以内
   - エラー率: 0.1%以下

---

## 🚀 今すぐ始められること

1. **開発環境セットアップ**
   ```bash
   # Frontend
   npx create-react-app ten-no-koe-app --template typescript
   
   # Backend
   pip install fastapi uvicorn openai
   ```

2. **最小限のプロトタイプ**
   - 1画面のチャットUI
   - OpenAI API連携
   - 簡単なフィードバック表示

3. **デモ用データ**
   - 会話サンプル10パターン
   - フィードバック例20種類

---

これで実装に入れる準備完了！🎉